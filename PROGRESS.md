# NEW-VOICE 2.0 ‚Äî –ü—Ä–æ–≥—Ä–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

## –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- **–ü—Ä–æ–µ–∫—Ç:** –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥–æ–ª–æ—Å–æ–≤—ã—Ö AI-–±–æ—Ç–æ–≤
- **–¶–µ–ª—å:** –ë–æ—Ç—ã –æ–±—â–∞—é—Ç—Å—è –∫–∞–∫ –ª—é–¥–∏, —Ä–∞–±–æ—Ç–∞—é—Ç —Å –≤—Ö–æ–¥—è—â–∏–º–∏/–∏—Å—Ö–æ–¥—è—â–∏–º–∏ –∑–≤–æ–Ω–∫–∞–º–∏
- **–ö–æ–º–ø–∞–Ω–∏—è:** AI Prosto
- **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** https://github.com/khak1m/new-voice
- **–°–µ—Ä–≤–µ—Ä:** 77.233.212.58 (Ubuntu 24.04, 2 vCPU, 4GB RAM, –ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã)

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –°—Ç–∞—Ç—É—Å |
|-----------|------------|--------|
| **LLM** | Ollama (qwen2:1.5b) | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| **STT** | Deepgram (nova-2) | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| **TTS** | Cartesia (sonic-2) | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| **Real-time** | LiveKit Cloud | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| **VAD** | Silero | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| **Database** | PostgreSQL + Qdrant + Redis | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| **RAG** | Qdrant + sentence-transformers | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| **Admin API** | FastAPI | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| **Telephony** | MTS Exolve | ‚è≥ –°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø |

---

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

### –≠—Ç–∞–ø 1: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- [x] –°–µ—Ä–≤–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω (Ubuntu 24.04)
- [x] Python 3.12, Docker, Git —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [x] GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–∑–¥–∞–Ω
- [x] –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (venv) –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

### –≠—Ç–∞–ø 2: LLM Provider
- [x] Groq –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω (–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –≤ –†–§ ‚Äî 403)
- [x] Ollama —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- [x] –ú–æ–¥–µ–ª—å qwen2:1.5b –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ OpenAI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π API

### –≠—Ç–∞–ø 3: Voice Pipeline ‚úÖ –ì–û–¢–û–í–û!
- [x] Deepgram STT –ø–æ–¥–∫–ª—é—á–µ–Ω (—Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫)
- [x] Cartesia TTS –ø–æ–¥–∫–ª—é—á–µ–Ω (—Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫)
- [x] LiveKit Cloud –ø–æ–¥–∫–ª—é—á–µ–Ω (—Ä–µ–≥–∏–æ–Ω Germany 2)
- [x] Silero VAD –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ—á–∏
- [x] **Voice Agent —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –≥–æ–ª–æ—Å–æ–º!**

### –≠—Ç–∞–ø 4: Scenario Engine (95%)
- [x] –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (models.py)
- [x] –ó–∞–≥—Ä—É–∑—á–∏–∫ –∫–æ–Ω—Ñ–∏–≥–æ–≤ (config_loader.py)
- [x] –ú–∞—à–∏–Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (state_machine.py)
- [x] –ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (context_manager.py)
- [x] –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–µ—á–∏ (field_extractor.py)
- [x] –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞ (language_detector.py)
- [x] –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (outcome_classifier.py)
- [x] –û—Å–Ω–æ–≤–Ω–æ–π –¥–≤–∏–∂–æ–∫ (engine.py)
- [x] **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Voice Agent (scenario_voice_agent.py)** ‚úÖ

### –≠—Ç–∞–ø 5: Database Setup ‚úÖ –ì–û–¢–û–í–û!
- [x] PostgreSQL –¥–æ–±–∞–≤–ª–µ–Ω –≤ docker-compose.yml
- [x] Qdrant –¥–æ–±–∞–≤–ª–µ–Ω –≤ docker-compose.yml
- [x] Redis –¥–æ–±–∞–≤–ª–µ–Ω –≤ docker-compose.yml
- [x] –°—Ö–µ–º–∞ –ë–î —Å–æ–∑–¥–∞–Ω–∞ (scripts/init_db.sql)
- [x] SQLAlchemy –º–æ–¥–µ–ª–∏ —Å–æ–∑–¥–∞–Ω—ã (src/database/)
- [x] –°–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ë–î (scripts/test_database.py)

### –≠—Ç–∞–ø 6: RAG System ‚úÖ –ì–û–¢–û–í–û!
- [x] –ú–æ–¥—É–ª—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ (src/rag/embeddings.py)
- [x] –ú–µ–Ω–µ–¥–∂–µ—Ä –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π (src/rag/knowledge_base.py)
- [x] RAG –ø–æ–∏—Å–∫ (src/rag/search.py)
- [x] –¢–µ—Å—Ç RAG (scripts/test_rag.py)

### –≠—Ç–∞–ø 7: Admin API ‚úÖ –ì–û–¢–û–í–û!
- [x] FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (src/api/main.py)
- [x] API –¥–ª—è –±–æ—Ç–æ–≤ (CRUD)
- [x] API –¥–ª—è –±–∞–∑ –∑–Ω–∞–Ω–∏–π (—Å–æ–∑–¥–∞–Ω–∏–µ, –¥–æ–∫—É–º–µ–Ω—Ç—ã, –ø–æ–∏—Å–∫)
- [x] API –¥–ª—è –∑–≤–æ–Ω–∫–æ–≤ (–ø—Ä–æ—Å–º–æ—Ç—Ä, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
- [x] API –¥–ª—è –ª–∏–¥–æ–≤ (–ø—Ä–æ—Å–º–æ—Ç—Ä, —ç–∫—Å–ø–æ—Ä—Ç CSV)
- [x] Health check —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

---

## üîÑ –°–õ–ï–î–£–Æ–©–ò–ï –ó–ê–î–ê–ß–ò

### 1. Admin UI (–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
- React/Next.js —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞–º–∏ —á–µ—Ä–µ–∑ UI
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–≤–æ–Ω–∫–æ–≤ –∏ –ª–∏–¥–æ–≤

### 2. –¢–µ–ª–µ—Ñ–æ–Ω–∏—è (MTS Exolve / Novofon)
- –ü–æ–¥–∫–ª—é—á–∏—Ç—å SIP trunk
- –í—Ö–æ–¥—è—â–∏–µ –∑–≤–æ–Ω–∫–∏ ‚Üí LiveKit
- –ò—Å—Ö–æ–¥—è—â–∏–µ –∑–≤–æ–Ω–∫–∏

---

## üìä –û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å

```
–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 100%
Scenario Engine: ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 100% ‚úÖ
Voice Pipeline:  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 100% ‚úÖ
Provider Layer:  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 100% ‚úÖ
Database:        ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 100% ‚úÖ
RAG System:      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 100% ‚úÖ
Admin API:       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 100% ‚úÖ
–¢–µ–ª–µ—Ñ–æ–Ω–∏—è:       ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 0%
Admin UI:        ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 0%
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ api/                         ‚úÖ Admin API (FastAPI)
‚îÇ   ‚îú‚îÄ‚îÄ main.py                  –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª API
‚îÇ   ‚îî‚îÄ‚îÄ routers/
‚îÇ       ‚îú‚îÄ‚îÄ bots.py              CRUD –¥–ª—è –±–æ—Ç–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ knowledge_bases.py   –ë–∞–∑—ã –∑–Ω–∞–Ω–∏–π
‚îÇ       ‚îú‚îÄ‚îÄ calls.py             –ò—Å—Ç–æ—Ä–∏—è –∑–≤–æ–Ω–∫–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ leads.py             –õ–∏–¥—ã
‚îÇ       ‚îî‚îÄ‚îÄ health.py            Health check
‚îú‚îÄ‚îÄ voice_agent/
‚îÇ   ‚îú‚îÄ‚îÄ simple_agent.py          ‚úÖ –ü—Ä–æ—Å—Ç–æ–π –∞–≥–µ–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ scenario_voice_agent.py  ‚úÖ –ê–≥–µ–Ω—Ç —Å–æ —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ agent.py                 –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∞–≥–µ–Ω—Ç
‚îú‚îÄ‚îÄ scenario_engine/
‚îÇ   ‚îú‚îÄ‚îÄ models.py         ‚úÖ –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ config_loader.py  ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ YAML/JSON
‚îÇ   ‚îú‚îÄ‚îÄ state_machine.py  ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ context_manager.py ‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç –∑–≤–æ–Ω–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ field_extractor.py ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ language_detector.py ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ outcome_classifier.py ‚úÖ –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ engine.py         ‚úÖ –û—Å–Ω–æ–≤–Ω–æ–π –¥–≤–∏–∂–æ–∫
‚îú‚îÄ‚îÄ rag/                         ‚úÖ RAG —Å–∏—Å—Ç–µ–º–∞
‚îÇ   ‚îú‚îÄ‚îÄ embeddings.py            –≠–º–±–µ–¥–¥–∏–Ω–≥–∏ (sentence-transformers)
‚îÇ   ‚îú‚îÄ‚îÄ knowledge_base.py        –ú–µ–Ω–µ–¥–∂–µ—Ä –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ search.py                –ü–æ–∏—Å–∫ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îú‚îÄ‚îÄ models.py         ‚úÖ SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ connection.py     ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
‚îú‚îÄ‚îÄ providers/
‚îÇ   ‚îú‚îÄ‚îÄ ollama_llm.py     ‚úÖ Ollama –ø—Ä–æ–≤–∞–π–¥–µ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ groq_llm.py       ‚ö†Ô∏è –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –≤ –†–§
scripts/
‚îú‚îÄ‚îÄ test_services.py      ‚úÖ –¢–µ—Å—Ç –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
‚îú‚îÄ‚îÄ test_database.py      ‚úÖ –¢–µ—Å—Ç PostgreSQL
‚îú‚îÄ‚îÄ test_rag.py           ‚úÖ –¢–µ—Å—Ç RAG
‚îú‚îÄ‚îÄ test_ollama.py        ‚úÖ –¢–µ—Å—Ç Ollama
examples/
‚îú‚îÄ‚îÄ scenarios/
‚îÇ   ‚îú‚îÄ‚îÄ salon_scenario.yaml   ‚úÖ –°–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ clinic_scenario.yaml  ‚úÖ –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –∫–ª–∏–Ω–∏–∫–∞
‚îî‚îÄ‚îÄ salon_bot_config.yaml ‚úÖ –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥–∞
```

---

## üîë API –ö–ª—é—á–∏ (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤ .env)

- DEEPGRAM_API_KEY ‚úÖ
- CARTESIA_API_KEY ‚úÖ
- LIVEKIT_URL ‚úÖ
- LIVEKIT_API_KEY ‚úÖ
- LIVEKIT_API_SECRET ‚úÖ

---

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å Voice Agent

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /root/new-voice
source venv/bin/activate

# –ü—Ä–æ—Å—Ç–æ–π –∞–≥–µ–Ω—Ç (–±–µ–∑ —Å—Ü–µ–Ω–∞—Ä–∏—è)
python -m src.voice_agent.simple_agent dev

# –ê–≥–µ–Ω—Ç —Å–æ —Å—Ü–µ–Ω–∞—Ä–∏–µ–º —Å–∞–ª–æ–Ω–∞
SCENARIO_PATH=examples/scenarios/salon_scenario.yaml python -m src.voice_agent.scenario_voice_agent dev

# –ê–≥–µ–Ω—Ç —Å–æ —Å—Ü–µ–Ω–∞—Ä–∏–µ–º –∫–ª–∏–Ω–∏–∫–∏
SCENARIO_PATH=examples/scenarios/clinic_scenario.yaml python -m src.voice_agent.scenario_voice_agent dev
```

–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: https://agents-playground.livekit.io/

---

## üåê –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å Admin API

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /root/new-voice
source venv/bin/activate

# –ó–∞–ø—É—Å—Ç–∏—Ç—å API
uvicorn src.api.main:app --host 0.0.0.0 --port 8000

# API –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å–∞–º:
# http://77.233.212.58:8000/       ‚Äî –∫–æ—Ä–µ–Ω—å
# http://77.233.212.58:8000/docs   ‚Äî Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
# http://77.233.212.58:8000/health ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
```

---

## üìÖ –ò—Å—Ç–æ—Ä–∏—è

| –î–∞—Ç–∞ | –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ |
|------|-------------|
| 2026-01-12 | –ù–∞—Å—Ç—Ä–æ–µ–Ω —Å–µ—Ä–≤–µ—Ä, —Å–æ–∑–¥–∞–Ω —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π |
| 2026-01-12 | –ù–∞–ø–∏—Å–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ |
| 2026-01-12 | –°–æ–∑–¥–∞–Ω Scenario Engine |
| 2026-01-12 | Groq –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Ollama |
| 2026-01-12 | –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Ollama —Å qwen2:1.5b |
| 2026-01-12 | –ü–æ–¥–∫–ª—é—á–µ–Ω—ã Deepgram, Cartesia, LiveKit |
| 2026-01-12 | **üéâ Voice Agent —Ä–∞–±–æ—Ç–∞–µ—Ç!** |
| 2026-01-12 | –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL, Qdrant, Redis) |
| 2026-01-12 | –°–æ–∑–¥–∞–Ω–∞ RAG —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π |
| 2026-01-12 | –°–æ–∑–¥–∞–Ω Admin API (FastAPI) |
