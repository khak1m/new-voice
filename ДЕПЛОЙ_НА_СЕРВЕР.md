# üöÄ –î–µ–ø–ª–æ–π –Ω–∞ –°–µ—Ä–≤–µ—Ä - –ü–æ—à–∞–≥–æ–≤–∞—è –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

## –ë—ã—Å—Ç—Ä—ã–π –°—Ç–∞—Ä—Ç (5 –º–∏–Ω—É—Ç)

### –®–∞–≥ 1: –°–æ–±–µ—Ä–∏—Ç–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (–Ω–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ)

```bash
cd new-voice-frontend
npm run build
```

–ü–æ—è–≤–∏—Ç—Å—è –ø–∞–ø–∫–∞ `dist/` —Å –≥–æ—Ç–æ–≤—ã–º —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º.

### –®–∞–≥ 2: –ó–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç (Windows)**

```bash
cd new-voice-frontend
deploy.bat
```

**–í–∞—Ä–∏–∞–Ω—Ç B: –í—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ SSH**

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh root@77.233.212.58 "mkdir -p /root/new-voice/frontend-dist"

# –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª—ã
scp -r dist/* root@77.233.212.58:/root/new-voice/frontend-dist/
```

**–í–∞—Ä–∏–∞–Ω—Ç C: –ß–µ—Ä–µ–∑ FileZilla/WinSCP**

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É 77.233.212.58
2. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É `/root/new-voice/frontend-dist`
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤—Å–µ —Ñ–∞–π–ª—ã –∏–∑ –ø–∞–ø–∫–∏ `dist/`

### –®–∞–≥ 3: –û–±–Ω–æ–≤–∏—Ç–µ main.py –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É:

```bash
ssh root@77.233.212.58
```

–ó–∞–º–µ–Ω–∏—Ç–µ —Ñ–∞–π–ª main.py:

```bash
cd /root/new-voice/src/api
cp main.py main_dev.py  # –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –æ—Ä–∏–≥–∏–Ω–∞–ª
cp main_production.py main.py  # –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –≤–µ—Ä—Å–∏—é
```

–ò–ª–∏ –≤—Ä—É—á–Ω—É—é –¥–æ–±–∞–≤—å—Ç–µ –≤ –∫–æ–Ω–µ—Ü `main.py` (–ü–û–°–õ–ï –≤—Å–µ—Ö —Ä–æ—É—Ç–µ—Ä–æ–≤):

```python
# –†–∞–∑–¥–∞—á–∞ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–î–û–õ–ñ–ù–û –ë–´–¢–¨ –ü–û–°–õ–ï–î–ù–ò–ú!)
from pathlib import Path

frontend_dist = Path(__file__).parent.parent.parent / "frontend-dist"

if frontend_dist.exists():
    print(f"‚úÖ –§—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–∞–π–¥–µ–Ω: {frontend_dist}")
    
    # –†–∞–∑–¥–∞–µ–º —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
    app.mount("/assets", StaticFiles(directory=str(frontend_dist / "assets")), name="assets")
    
    # –†–∞–∑–¥–∞–µ–º index.html –¥–ª—è –≤—Å–µ—Ö –ø—É—Ç–µ–π (SPA routing)
    @app.get("/{full_path:path}")
    async def serve_spa(full_path: str):
        if full_path.startswith("api/"):
            return {"error": "Not found"}
        
        file_path = frontend_dist / full_path
        if file_path.is_file():
            return FileResponse(file_path)
        
        index_file = frontend_dist / "index.html"
        if index_file.exists():
            return FileResponse(index_file)
        
        return {"error": "Frontend not found"}
```

### –®–∞–≥ 4: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ API –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å—Ç–∞—Ä—ã–π –ø—Ä–æ—Ü–µ—Å—Å
pkill -f uvicorn

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–æ–≤—ã–π
cd /root/new-voice
nohup python -m uvicorn src.api.main:app --host 0.0.0.0 --port 8000 > logs/api.log 2>&1 &

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è
tail -f logs/api.log
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
üöÄ NEW-VOICE API –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è (PRODUCTION MODE)...
‚úÖ –§—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–∞–π–¥–µ–Ω: /root/new-voice/frontend-dist
INFO:     Uvicorn running on http://0.0.0.0:8000
```

### –®–∞–≥ 5: –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

```
http://77.233.212.58:8000
```

**–ì–æ—Ç–æ–≤–æ!** üéâ

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API

```
http://77.233.212.58:8000/docs
```

–î–æ–ª–∂–Ω–∞ –æ—Ç–∫—Ä—ã—Ç—å—Å—è Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è.

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥

```
http://77.233.212.58:8000
```

–î–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã—Ç—å—Å—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å NEW-VOICE.

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

–û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) ‚Üí Network ‚Üí –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ `/api/dashboard/stats` –∏ –¥—Ä—É–≥–∏–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º.

---

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

–ö–æ–≥–¥–∞ –≤—ã –≤–Ω–æ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

```bash
# 1. –°–æ–±–µ—Ä–∏—Ç–µ –∑–∞–Ω–æ–≤–æ
cd new-voice-frontend
npm run build

# 2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
deploy.bat

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
scp -r dist/* root@77.233.212.58:/root/new-voice/frontend-dist/

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ù–ï –Ω—É–∂–µ–Ω! –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—Ç—Å—è —Å—Ä–∞–∑—É
```

---

## –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞

–°–æ–∑–¥–∞–π—Ç–µ systemd —Å–µ—Ä–≤–∏—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
ssh root@77.233.212.58
```

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `/etc/systemd/system/new-voice.service`:

```ini
[Unit]
Description=NEW-VOICE API
After=network.target postgresql.service

[Service]
Type=simple
User=root
WorkingDirectory=/root/new-voice
Environment="PATH=/usr/local/bin:/usr/bin:/bin"
ExecStart=/usr/bin/python3 -m uvicorn src.api.main:app --host 0.0.0.0 --port 8000
Restart=always
RestartSec=10
StandardOutput=append:/root/new-voice/logs/api.log
StandardError=append:/root/new-voice/logs/api.log

[Install]
WantedBy=multi-user.target
```

–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ:

```bash
systemctl daemon-reload
systemctl enable new-voice
systemctl start new-voice
systemctl status new-voice
```

–¢–µ–ø–µ—Ä—å API –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞.

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:

```bash
systemctl start new-voice    # –ó–∞–ø—É—Å—Ç–∏—Ç—å
systemctl stop new-voice     # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
systemctl restart new-voice  # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
systemctl status new-voice   # –°—Ç–∞—Ç—É—Å
journalctl -u new-voice -f   # –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
```

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Nginx (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Ä—Ç 80 –≤–º–µ—Å—Ç–æ 8000:

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Nginx

```bash
ssh root@77.233.212.58
apt update
apt install nginx -y
```

### 2. –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `/etc/nginx/sites-available/new-voice`:

```nginx
server {
    listen 80;
    server_name 77.233.212.58;

    # –õ–æ–≥–∏
    access_log /var/log/nginx/new-voice-access.log;
    error_log /var/log/nginx/new-voice-error.log;

    # API
    location /api {
        proxy_pass http://localhost:8000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

    # Swagger UI
    location /docs {
        proxy_pass http://localhost:8000;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
    }

    # Health check
    location /health {
        proxy_pass http://localhost:8000;
    }

    # –§—Ä–æ–Ω—Ç–µ–Ω–¥
    location / {
        proxy_pass http://localhost:8000;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
```

### 3. –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ

```bash
ln -s /etc/nginx/sites-available/new-voice /etc/nginx/sites-enabled/
nginx -t
systemctl restart nginx
```

–¢–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞:

```
http://77.233.212.58
```

---

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –§—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**

```bash
ssh root@77.233.212.58

# –§–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã?
ls -la /root/new-voice/frontend-dist/

# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å: index.html, assets/, –∏ –¥—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã

# –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
chmod -R 755 /root/new-voice/frontend-dist/

# API –∑–∞–ø—É—â–µ–Ω?
ps aux | grep uvicorn

# –õ–æ–≥–∏
tail -f /root/new-voice/logs/api.log
```

### –ü—Ä–æ–±–ª–µ–º–∞: API –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å
ps aux | grep uvicorn

# –ï—Å–ª–∏ –Ω–µ –∑–∞–ø—É—â–µ–Ω, –∑–∞–ø—É—Å—Ç–∏—Ç–µ
cd /root/new-voice
nohup python -m uvicorn src.api.main:app --host 0.0.0.0 --port 8000 > logs/api.log 2>&1 &

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
tail -f logs/api.log
```

### –ü—Ä–æ–±–ª–µ–º–∞: 404 –Ω–∞ API –∑–∞–ø—Ä–æ—Å–∞—Ö

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—è–¥–æ–∫ –≤ main.py:**

–†–∞–∑–¥–∞—á–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –î–û–õ–ñ–ù–ê –±—ã—Ç—å –ü–û–°–õ–ï–î–ù–ï–ô, –ø–æ—Å–ª–µ –≤—Å–µ—Ö `app.include_router()`.

### –ü—Ä–æ–±–ª–µ–º–∞: –ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è

```bash
# –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞ (Ctrl+Shift+R)

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª—ã –æ–±–Ω–æ–≤–∏–ª–∏—Å—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh root@77.233.212.58
ls -la /root/new-voice/frontend-dist/
```

---

## Checklist

### –ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º:

- [ ] –§—Ä–æ–Ω—Ç–µ–Ω–¥ —Å–æ–±—Ä–∞–Ω (`npm run build`)
- [ ] –ü–∞–ø–∫–∞ `dist/` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- [ ] SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Python –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:

- [ ] –§–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ `/root/new-voice/frontend-dist/`
- [ ] `main.py` –æ–±–Ω–æ–≤–ª–µ–Ω (–¥–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–∞–∑–¥–∞—á–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞)
- [ ] API –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- [ ] –§—Ä–æ–Ω—Ç–µ–Ω–¥ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è: http://77.233.212.58:8000
- [ ] API —Ä–∞–±–æ—Ç–∞–µ—Ç: http://77.233.212.58:8000/docs
- [ ] API –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ DevTools)

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@77.233.212.58

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã
ps aux | grep uvicorn

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å API
pkill -f uvicorn

# –ó–∞–ø—É—Å—Ç–∏—Ç—å API
cd /root/new-voice
nohup python -m uvicorn src.api.main:app --host 0.0.0.0 --port 8000 > logs/api.log 2>&1 &

# –°–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
tail -f /root/new-voice/logs/api.log

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç—ã
netstat -tulpn | grep 8000

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API
curl http://localhost:8000/health
```

---

**–î–∞—Ç–∞:** 2026-01-18  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é
